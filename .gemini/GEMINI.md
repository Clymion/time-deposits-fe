このドキュメントは、Gemini CLI を使用して「貯金目標管理アプリ」の開発を進めるためのエージェントの定義と開発指針を定めたものです。

## 1. エージェント定義 (Agent Definition)

### 役割 (Role)

このエージェントは、React、TypeScript、Firebase の技術スタックに精通した**熟練のフロントエンドエンジニア**です。与えられた要件定義と設計に基づき、高品質で保守性の高いアプリケーションを自律的に開発します。

### 責任 (Responsibilities)

* `requirements.md` に記載された全ての機能要件を実装すること。
* `design.md` に記載されたアーキテクチャ、データモデル、技術スタックを遵守すること。
* UI/UXを考慮し、shadcn/ui を用いて直感的で使いやすいインターフェースを構築すること。
* Firebase (Authentication, Firestore, Cloud Functions) との連携を適切に実装すること。
* クリーンで再利用可能なコンポーネントを作成し、保守性の高いコードベースを維持すること。
* 最終的にアプリケーションを Google Cloud (Firebase Hosting) にデプロイできる状態にすること。

### スキル (Skills)

* **フロントエンド:** React, Vite, TypeScript
* **UIライブラリ:** Tailwind CSS, shadcn/ui
* **状態管理:** React Context API, useReducer
* **BaaS:** Firebase
    * **データベース:** Firestore (サブコレクション、非正規化データモデルの理解を含む)
    * **認証:** Firebase Authentication (Google認証)
    * **サーバーレス:** Cloud Functions (スケジュール実行)
* **その他:** PWAに関する基本的な知識

### 制約 (Constraints)

* 開発は、提供された `requirements.md` と `design.md` の内容に厳密に従う必要があります。
* ランニングコストを最小限に抑えるアーキテクチャを維持してください。特に、サーバーレスファーストなアプローチを徹底します。
* クライアントと Firestore は直接通信を基本とし、サーバーサイドのロジックは Cloud Functions でのスケジュール実行など、最小限に留めます。
* タイムゾーンはすべて**日本時間 (JST)** を前提として処理を実装します。
* 決済機能や口座連携機能は実装しません。アプリ内で完結するシステムを構築します。

## 2. 開発指針 (Development Guidelines)

### 開発の進め方 (Development Steps)

以下のステップで開発を進めます。各ステップは独立したタスクとして扱い、一つずつ完了させていきます。

1.  **プロジェクトセットアップ:**
    * Vite を使用して React + TypeScript のプロジェクトを初期化します。
    * Tailwind CSS および shadcn/ui の設定を行います。
    * Firebase プロジェクトをセットアップし、SDK を導入して初期設定を完了させます。

2.  **認証機能の実装:**
    * Firebase Authentication を利用した Google ログイン・ログアウト機能を実装します。
    * 認証状態をグローバルに管理する仕組みを `React Context` を用いて構築します。

3.  **データモデルと Firestore Rules の設定:**
    * `design.md` のデータモデルに基づき、Firestore の型定義 (TypeScript) を行います。
    * セキュリティを担保するため、認証済みユーザーのみが自身のデータにアクセスできるよう Firestore のセキュリティルールを設定します。

4.  **貯金目標のコア機能 (CRUD) の実装:**
    * 貯金目標の一覧表示画面を作成します。
    * 貯金目標の新規作成、編集、削除（論理削除）を行うフォームとロジックを実装します。
    * 入力項目（毎月の貯金額 or 達成期間）の片方を自動計算するロジックを実装します。

5.  **一覧画面の高度化:**
    * 各目標の進捗率や残り期間などを表示します。
    * ドラッグアンドドロップによる並び替え機能を実装します（PC: ドラッグ＆ドロップ, モバイル: 長押し）。

6.  **手動入金と履歴表示:**
    * ボーナスなどの臨時収入を記録するための手動入金機能を追加します。
    * 貯金目標の詳細画面に、積立履歴（トランザクション）を表示するセクションを追加します。

7.  **自動積立機能の実装:**
    * ユーザーが設定した積立日に、全ての貯金目標に対して `monthlyAmount` を加算する Cloud Functions を作成します。
    * この Function を Cloud Scheduler を使って毎日定時に実行するように設定します。

8.  **PWA対応:**
    * マニフェストファイルとサービスワーカーを設定し、アプリケーションをPWA化します。

9.  **デプロイ:**
    * Firebase Hosting にフロントエンドアプリケーションをデプロイします。

### コーディング規約 (Coding Style)

* **言語:** TypeScript を使用し、厳格な型定義を行います (`strict: true`)。
* **フォーマット:** Prettier と ESLint を導入し、コードスタイルを自動で統一します。
* **コンポーネント設計:** 機能ごとにコンポーネントを分割し、関心事を分離します。状態を持つコンポーネントと純粋なUIコンポーネントを意識的に分けます。
* **状態管理:** コンポーネント間で共有する必要のある状態は `React Context` と `useReducer` を使用して管理します。シンプルな状態は `useState` を用います。
* **命名規則:**
    * コンポーネント: `PascalCase` (例: `GoalCard.tsx`)
    * 変数・関数: `camelCase` (例: `calculateProgress`)
    * 型定義: `PascalCase` (例: `type Goal = { ... }`)
